% Flatland types and terms                                                          
%
% these commands based from icfp07 defs

\newcommand{\Es}[2]{#1,\,\ldots,\,#2}
\newcommand{\Xs}{\Es{X_1}{X_n}}
\newcommand{\Ys}{\Es{Y_1}{Y_n}}
\newcommand{\Ds}{\Es{d_1}{d_n}}
\newcommand{\Vs}{\Es{v_1}{v_n}}

\newcommand{\Fsigma}{\ensuremath{\sigma}}
\newcommand{\Frho}{\ensuremath{\rho}}
\newcommand{\Fnu}{\ensuremath{\nu}}

\newcommand{\TUniv}[2]{\forall #1 . #2}
\newcommand{\TUnit}{\rm{unit}}
\newcommand{\TInt}{\mathit{int}}
\newcommand{\TBool}{\mathit{bool}}
\newcommand{\TExn}{\rm{exn}}
\newcommand{\TVar}[1]{#1}
\newcommand{\TParr}[1]{[\ensuremath{#1}]}
\newcommand{\TFParr}[2]{\{#1 \; ; \; #2 \, \}}
\newcommand{\TFPF}[1]{\TFParr{#1}{\TLf}}
\newcommand{\TPair}[2]{(#1,#2)}
\newcommand{\TFun}[2]{#1 \rightarrow #2}
\newcommand{\TTree}{\nu}
\newcommand{\TLf}{\textit{lf}}
\newcommand{\TNd}[1]{\textit{nd}(#1)}
\newcommand{\TNestingTree}{\textsc{nt}}
\newcommand{\TIR}[2]{\langle #1 / #2 \rangle} %IR = interface, representation
\newcommand{\TIRM}[1]{\TIR{#1}{#1}}
\newcommand{\TOr}[2]{#1 \rm{?} #2}

\newcommand{\TAssocOp}[1]{\TFun{\TPair{#1}{#1}}{#1}}

\newcommand{\Fkw}[1]{\mathbf{#1}}

\newcommand{\Fterm}{\ensuremath{t}}
%abbrev
\newcommand{\Ftm}{\Fterm}

\newcommand{\Fexp}{\ensuremath{e}}
\newcommand{\Flexp}{\flt{\Fexp}}

\newcommand{\Funit}{()}
\newcommand{\Fint}[1]{#1}
\newcommand{\Fop}[1]{\texttt{#1}}
\newcommand{\Fplus}[2]{#1 + #2}

\newcommand{\compose}[2]{#1 \circ #2}
\newcommand{\composeP}[2]{\compose{(#1)}{(#2)}}

\newcommand{\paircompose}[2]{\ensuremath{#1 \otimes #2}}
\newcommand{\defeq}{\stackrel{\text{\tiny def}}{=}}
%\newcommand{\definition}[2]{#1 \defeq #2}
\newcommand{\bottom}{\perp}

\newcommand{\flt}[1]{\ensuremath{\overline{#1}}}
\newcommand{\ftau}{\flt{\tau}}

\newcommand{\Ftrue}{\rm{true}}
\newcommand{\Ffalse}{\rm{false}}
\newcommand{\Fif}[3]{\Fkw{if} \ #1 \ \Fkw{then} \ #2 \ \Fkw{else} \ #3}

%% \newcommand{\Flet}[4]{\Fkw{let} \ \Ftyp{#1}{#2} = #3 \ \Fkw{in} \ #4}
%% \newcommand{\FletLn}[4]{
%%   \begin{array}{l}
%%     \Fkw{let} \ \Ftyp{#1}{#2} = #3 \ \Fkw{in} \\
%%     \quad #4
%%   \end{array}
%% }

\newcommand{\Nlet}[3]{\Fkw{let} \ #1 = #2 \ \Fkw{in} \ #3}
\newcommand{\NletLn}[3]{
  \begin{array}{l}
    \Fkw{let} \ #1 = #2 \ \Fkw{in} \\
    \quad #3
  \end{array}
}

\newcommand{\Ffun}[5]{\Fkw{fun} \ #1 \; \Ftyp{#2}{#3} = #4 \ \Fkw{in} \ #5}
\newcommand{\FfunLn}[5]{
  \begin{array}{l}
    \Fkw{fun} \ #1 \; \Ftyp{#2}{#3} = #4 \ \Fkw{in} \\
    \quad #5
  \end{array}
}

\newcommand{\Fvar}[1]{\textit{#1}}

\newcommand{\Ffstkw}{\Fkw{fst}}
\newcommand{\Fsndkw}{\Fkw{snd}}

\newcommand{\Ffst}[1]{\Ffstkw \ #1}
\newcommand{\Fsnd}[1]{\Fsndkw \ #1}

\newcommand{\FprojOp}[1]{\pi_{#1}}
\newcommand{\Fproj}[2]{\FprojOp{#1} \ #2}

\newcommand{\Fparr}[1]{[{}#1{}]}
\newcommand{\Ffprempty}{\{\}}
\newcommand{\Ffpr}[2]{\{#1 ; #2\}}

\newcommand{\FsubOp}[1]{!_{#1}}
\newcommand{\Fsub}[3]{#2 \ \FsubOp{#1} \ #3}

\newcommand{\Fpair}[2]{({}#1,#2{})}
\newcommand{\Flam}[3]{\lambda #1:#2.\ #3}
\newcommand{\Flamu}[2]{\lambda #1.\ #2}
\newcommand{\Ftyfun}[3]{\Fkw{Fun} \ #1(#2) = #3}
\newcommand{\Ftapp}[2]{#1[#2]}

\newcommand{\Fapp}[2]{#1 \ #2}
\newcommand{\FappP}[2]{(#1) \ #2}

\newcommand{\Fexn}{\ensuremath{E}}
\newcommand{\Fraise}[1]{\Fkw{raise} \ #1}
\newcommand{\Fhandle}[2]{#1 \ \Fkw{handle} \ E \Rightarrow #2}

\newcommand{\Fcomp}[2]{\compose{#1}{#2}}

\newcommand{\Fmapname}{\Fkw{map}}
\newcommand{\Ffiltname}{\Fkw{filt}}
\newcommand{\Freducename}{\Fkw{red}}

\newcommand{\FmapOp}[4]{\Fmapname_{(#1,#2,#3,#4)}}
\newcommand{\Fmap}[6]{\Fapp{\FmapOp{#1}{#2}{#3}{#4}}\Fpair{#5}{#6}}
\newcommand{\FmapN}[4]{\Fapp{\Fapp{\Fmapname_{#1,#2}}{#3}}{#4}}
\newcommand{\FmapF}[5]{\Fapp{\Fapp{\overline{\Fmapname}_{#1,#2,#3}}{#4}}{#5}}

\newcommand{\FfiltN}[3]{\Fapp{\Fapp{\Ffiltname_{#1}}{#2}}{#3}}
\newcommand{\FfiltF}[4]{\Fapp{\Fapp{\overline{\Ffiltname}_{#1,#2}}{#3}}{#4}}

\newcommand{\FfiltOp}[2]{\Ffiltname_{(#1,#2)}}
\newcommand{\Ffilt}[4]{\Fapp{\FfiltOp{#1}{#2}}{\Fpair{#3}{#4}}}

\newcommand{\FmapShort}[2]{\Fapp{\Fmapname}{\Fpair{#1}{#2}}}
\newcommand{\FFmapShort}[2]{\Fapp{\flt{\Fmapname}}{\Fpair{#1}{#2}}}

\newcommand{\FreduceOp}[2]{\Freducename_{(#1,#2)}}
\newcommand{\Freduce}[5]{\Fapp{\FreduceOp{#1}{#2}}{(#3,#4,#5)}}

\newcommand{\FreduceShort}[3]{\Fapp{\Freducename}{(#1,#2,#3)}}
\newcommand{\FFreduceShort}[3]{\Fapp{\flt{\Freducename}}{(#1,#2,#3)}}

\newcommand{\FreduceN}[4]{\Fapp{\Fapp{\Fapp{\Freducename_{#1}}{#2}}{#3}}{#4}}
\newcommand{\FreduceF}[5]{\Fapp{\Fapp{\Fapp{\overline{\Freducename}_{#1,#2}}{#3}}{#4}}{#5}}
\newcommand{\Flf}[2]{\Fkw{lf}(#1,#2)}
\newcommand{\Fnd}[1]{\Fkw{nd}[{#1}]}

\newcommand{\Ftyp}[2]{{#1}^{#2}}
\newcommand{\FtypP}[2]{\Ftyp{(#1)}{#2}}

\newcommand{\stdtyp}[2]{\Ftyp{\Fexp_{#1}}{\tau_{#2}}}
\newcommand{\stdtypP}[2]{(\stdtyp{#1}{#2})}

\newcommand{\Fkind}[1]{\{ #1 \}}
\newcommand{\Fcomm}[1]{\hbump \texttt{(*} \; \textit{#1} \; \texttt{*)}}
\newcommand{\Fappop}[2]{\Fapp{\Fop{#1}}{#2}}
\newcommand{\FappopTwo}[3]{\Fapp{\Fapp{\Fop{#1}}{#2}}{#3}}
\newcommand{\Funzip}[1]{\Fappop{unzip}{#1}}
\newcommand{\Flen}[1]{\Fappop{len}{#1}}
\newcommand{\FmkLf}{\Fop{mkLf}}
\newcommand{\Fprim}[1]{\underline{\texttt{#1}}}
\newcommand{\Fid}{\Fkw{id}}
\newcommand{\Fsubst}[3]{[#1/#2]#3}

% coercion operators

\newcommand{\Fcoerce}[2]{\ensuremath{{#1}\triangleright{#2}}}
\newcommand{\FselfCoerce}[1]{\Fcoerce{#1}{#1}}
% abbrev
\newcommand{\CO}[2]{\Fcoerce{#1}{#2}}
\newcommand{\stdCO}[1]{\Fcoerce{\tau_{#1}}{\ftau_{#1}}}
\newcommand{\stdOC}[1]{\Fcoerce{\ftau_{#1}}{\tau_{#1}}}

\newcommand{\Cid}[1]{\Fkw{id}_{#1}}

\newcommand{\CtoFA}[1]{\Fkw{toFA}_{#1}}
\newcommand{\CfromFA}[1]{\Fkw{fromFA}_{#1}}

\newcommand{\Ccat}[3]{\Fkw{cat}_{\TFParr{\TFParr{#1}{#2}}{#3}}}
\newcommand{\Cseg}[2]{\Fkw{seg}_{\TFParr{#1}{#2}}}

\newcommand{\Cmap}[1]{\Fkw{map}_{#1}}

\newcommand{\Czip}[2]{\Fkw{zip}_{\TPair{#1}{#2}}}
\newcommand{\Cunzip}[1]{\Fkw{unzip}_{#1}}

% type-indexed operators
\newcommand{\Fflt}[1]{\Fop{fl}_{#1}}
\newcommand{\FfltRho}[1]{\textsc{fl}_{#1}}
\newcommand{\Fnest}[1]{\Fop{nest}_{#1}}

\newcommand{\Fnote}[1]{\hspace{1em} \textit{-- #1}}

%\newcommand{\Blet}[3]{\Bkw{let}\,#1 = #2\,\Bkw{in}\,#3}
%\newcommand{\Bdo}[2]{\Blet{\Punit}{#1}{#2}}
%\newcommand{\Bdo}[2]{\Bkw{do}\,#1\,\Bkw{in}\,#2}
%\newcommand{\Bprim}[4]{\Blet{#1}{\Bapply{#2}{#3}}{#4}}
%\newcommand{\Bif}[3]{\Bkw{if}\,#1\,\Bkw{then}\,#2\,\Bkw{else}\,#3}
%\newcommand{\Bfun}[4]{\Bkw{fun}\,#1(#2) = #3\,\Bkw{in}\,#4}
%\newcommand{\Bapply}[2]{#1(#2)}
%\newcommand{\Bcont}[4]{\Bkw{letcont}\,#1(#2) = #3\,\Bkw{in}\,#4}
%\newcommand{\Bthrow}[2]{\Bkw{throw}\,#1(#2)}
%\newcommand{\Brun}[2]{\Bkw{run}\;(#1,\,#2)}
%\newcommand{\Bforward}[1]{\Bkw{forward}\;(#1)}
%
% BOM terms in example code
%
%\newcommand{\Bletin}[2]{\Bkw{let}\,#1 = #2\,\Bkw{in}}
%\newcommand{\Bdoin}[1]{\Bletin{\Punit}{#1}}
%\newcommand{\Bdoin}[1]{\Bkw{do}\,#1\,\Bkw{in}}
%\newcommand{\Bprimin}[3]{\Blet{#1}{\Bapply{#2}{#3}}}
%\newcommand{\Bfunin}[3]{\Bkw{fun}\,#1(#2) = #3\,\Bkw{in}}
%\newcommand{\Bcontin}[3]{\Bkw{letcont}\,#1(#2) = #3\,\Bkw{in}}
%\newcommand{\Bid}[1]{\mathit{#1}}

% judgments etc.
\newcommand{\hbump}{\hspace{2.0em}}
\newcommand{\vbump}{\vspace{0.75em}}

\newcommand{\suchthat}{\ensuremath{\;\rm{s.t.}\;}}
\newcommand{\turnstile}{\vdash}

\newcommand{\hastype}[2]{\ensuremath{#1 \ \rm{:} \ #2}}
\newcommand{\wf}[1]{#1 \ \textit{ok}}

\newcommand{\proves}[2]{\ensuremath{#1 \turnstile #2}}
\newcommand{\proveswf}[2]{\ensuremath{#1 \turnstile \wf{#2}}}
\newcommand{\gwf}[1]{\proveswf{\Gamma}{#1}}

\newcommand{\wfc}[2]{\proves{}{\wf{\Fcoerce{#1}{#2}}}}
\newcommand{\wfcP}[2]{\proves{}{\wf{(\Fcoerce{#1}{#2})}}}

\newcommand{\stdwf}[2]{\proveswf{\Gamma}{\Ftyp{#1}{#2}}}
\newcommand{\stdwfP}[2]{\stdwf{(#1)}{#2}}

\newcommand{\rulename}[1]{\textsc{#1}}

\newcommand{\judgment}[2]{\frac{#1}{#2}}
\newcommand{\njudgment}[3]{\judgment{#1}{#2}\ \rulename{#3}}
\newcommand{\unnjudgment}[3]{\judgment{#1}{#2}}

\newcommand{\axiom}[1]{\judgment{}{#1}}
\newcommand{\naxiom}[2]{\njudgment{}{#1}{#2}}
\newcommand{\unnaxiom}[2]{\unnjudgment{}{#1}{#2}}

\newcommand{\taut}[1]{\proves{}{#1}}

\newcommand{\extend}[3]{#1[\Ftyp{#2}{#3}]}
\newcommand{\extendTwo}[5]{\extend{\extend{#1}{#2}{#3}}{#4}{#5}}
\newcommand{\extendThree}[7]{\extend{\extendTwo{#1}{#2}{#3}{#4}{#5}}{#6}{#7}}
\newcommand{\extendFour}[9]{\extend{\extendThree{#1}{#2}{#3}{#4}{#5}{#6}{#7}}{#8}{#9}}

\newcommand{\openty}[1]{\TScheme{#1}{#1}}
\newcommand{\unify}[2]{#1 \ \mathbf{u} \  #2}

\newcommand{\fv}[1]{\rm{FV}(#1)}
\newcommand{\fresh}[1]{\Fvar{#1} \; \textrm{fresh}}

\newcommand{\ftrx}{\searrow}
\newcommand{\ftrxty}{\ftrx}

\newcommand{\bigstep}[5]{#1 \turnstile \Ftyp{#2}{#3} \ftrx 
                         (\CO{#5}{#3}) \diamond \Ftyp{#4}{#5}}
\newcommand{\bigstepP}[5]{\bigstep{#1}{(#2)}{#3}{(#4)}{#5}}

\newcommand{\bigstepD}[4]{\bigstep{\Delta}{#1}{#2}{#3}{#4}}
\newcommand{\bigstepDP}[4]{\bigstepP{\Delta}{#1}{#2}{#3}{#4}}

\newcommand{\bigstepLn}[5]{
  \begin{array}{l}
    #1 \turnstile \Ftyp{#2}{#3} \\
      \quad \ftrx 
            (\CO{#5}{#3}) \diamond \Ftyp{#4}{#5}
  \end{array}
}
\newcommand{\stdbig}[2]{\bigstepD{\Fexp_{#1}}
                                 {\tau_{#1}}
                                 {\Flexp_{#2}}
                                 {\ftau_{#2}}}

\newcommand{\stdbigP}[2]{\bigstepDP{\Fexp_{#1}}
                                   {\tau_{#1}}
                                   {\Flexp_{#2}}
                                   {\ftau_{#2}}}

\newcommand{\termflat}[1]{\Fterm_{#1} \ftrx \flt{\Fterm}_{#1}}

\newcommand{\ssftty}{\rightarrowtail}
\newcommand{\ssfttm}{\mapsto}

\newcommand{\sembrack}[1]{[\![#1]\!]}
\newcommand{\lil}{\hspace{0.25mm}}

\newcommand{\ftyfnop}{\mathbf{F}}
\newcommand{\ftyfn}[1]{\ftyfnop \sembrack{\lil#1\lil}}

\newcommand{\wrapop}{\mathbf{N}}
\newcommand{\wrap}[1]{\wrapop \sembrack{#1}}

\newcommand{\lam}{\lambda}

\newcommand{\fte}[2]{\ensuremath{#1 \leqslant #2}}
\newcommand{\selectSym}{!}
\newcommand{\select}[1]{\ensuremath{\selectSym \; #1}}
\newcommand{\TC}[1]{\ensuremath{#1^{*}}}
\newcommand{\aOf}[1]{\ensuremath{A(#1)}}
\newcommand{\inA}[2]{\ensuremath{#1 \in \aOf{#2}}}

\newcommand{\containSym}[1]{\ensuremath{C_{#1}}}
\newcommand{\contain}[2]{\ensuremath{\containSym{#1}(#2)}}

\newcommand{\pmlc}{\texttt
{pmlc}}
\newcommand{\bom}{\textsc{bom}}

\newcommand{\vvv}[1]{\overrightarrow{#1}}

\newcommand{\rA}{\mathbf{A}}
\newcommand{\rL}{\mathbf{L}}

\newcommand{\relA}[2]{#1 \; \rA \; #2}
\newcommand{\relL}[2]{#1 \; \rL \; #2}

\newcommand{\shapety}[2]{\ensuremath{\proves{\Gamma}{\hastype{#1}{#2}}}}

\newcommand{\anoncite}[1]{[\textit{anonymous-citation}]}
